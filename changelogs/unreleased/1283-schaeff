Reduce memory usage and runtime by refactoring the reducer (ssa, propagation, unrolling and inlining)