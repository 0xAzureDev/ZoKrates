import "ecc/babyjubjubParams.code" as context
import "ecc/proofOfOwnership.code" as proofOfOwnership

def proofOfKnowledge(private field i1, private field i2, private field i3, private field i4, field h0, field h1) -> (field):
    field[2] digest = [i1, i2]
    digest[0] == h0
    digest[1] == h1
    return 1

def main(private field i1, private field i2, private field i3, private field i4, field h0, field h1, private field skA, field[2] pkA, private field skB, field[2] pkB) -> (field):

    context = context()
    field AhasKnowledge = proofOfKnowledge(i1, i2, i3, i4, h0, h1)
    field AhasOwnership = proofOfOwnership(pkA, skA, context)
    field BhasOwnership = proofOfOwnership(pkB, skB, context)

    field isAwithKnowledge = if AhasKnowledge == 1 && AhasOwnership == 1 then 1 else 0 fi
    field out = if isAwithKnowledge == 1 || BhasOwnership == 1 then 1 else 0 fi

    return out